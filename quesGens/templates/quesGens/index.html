{% extends 'quesGens/base.html' %}
{% load static %}
{% block content %}
<main>
    <div class="container">
        <div class="header">
            <h2>MCQ Generator</h2>

            {% if user.is_authenticated %}
            <br>
            <br>
            <div class="dropdown">
                <div style=" line-height: 54px; height: 50px;"><a href="#"><img onclick="toggleDropdown()"
                            style="width: 50px; height: 50px; margin-left:50px;" class="rounded-circle account-img"
                            src="{{ user.profile.image.url }}"></a>
                </div>
                {% if request.user.is_authenticated %}
                <div id="dropdownMenu" class="dropdown-menu extra">
                    <a href="#" class="dropdown-item" onclick="downloadPDF()"><i class="fa-regular fa-user"></i>
                        <div class="account">
                            <h3 style="font-size:12px;">Account details</h3>
                            <span>{{ user.email }}</span>
                        </div>
                    </a>
                    <hr>
                    <a href="#" class="dropdown-item" onclick="downloadPDF()"><i class="fa-solid fa-globe"></i>
                        Notifications</a>
                    <a href="#" class="dropdown-item"><i class="fa-solid fa-toggle-on"></i> Dark mode</a>
                    <a href="#" class="dropdown-item"><i class="fas fa-file-word"></i> Help Center</a>
                    <a href="{% url 'about' %}" class="dropdown-item"><i class="fa-solid fa-address-card"></i> Contact us</a>
                     <hr>
                    <form style="border:0px;" action="{% url 'logout' %}" method="POST">
                        {% csrf_token %}
                        <button style="color:#333; font-size:15px; background-color:transparent;" type="submit" class="logout-btn"><i style="margin-right:12px" class="fa-solid fa-right-from-bracket"></i>Log out</button>
                    </form>

                </div>
                {% else %}
                <div id="dropdownMenu" class="dropdown-menu extra">
                    <a href="#" class="dropdown-item"><i class="fa-solid fa-right-to-bracket"></i> Login/Signup</a>
                    <hr>
                    <a href="#" class="dropdown-item"><i class="fa-solid fa-globe"></i>Notifications</a>
                    <a href="#" class="dropdown-item"><i class="fa-solid fa-toggle-on"></i> Dark mode</a>
                    <a href="#" class="dropdown-item"><i class="fas fa-file-word"></i>Help Center</a>
                    <a href="#" class="dropdown-item"><i class="fa-solid fa-address-card"></i> Contact us</a>
                </div>

                {% endif %}



            </div>
            {% else %}
            <button id="loginBtn" class="login-btn"><i style="margin-right:12px" class="fa-regular fa-user"></i>Login</button>
            {% endif %}
        </div>

        <h2>Enter Text and Number of Keywords to Generate MCQs</h2>
        <br><br>
        <form method="post">
            {% csrf_token %}
            <div class="form-group" style="position: relative; border-bottom:2px solid #dcdfe4">
                <!-- <label for="context">Context</label> -->
                <!-- The textarea -->
                <textarea id="context" name="context" rows="4"
                    style="width:100%; color:#172b4d; padding: 10px;line-height:28px; font-size:16px; border:none;"
                    placeholder='To write text, enter or paste it here and press "generate".'></textarea>
                <!-- <div class="buttons-container" style="position: absolute; top: 70px; right: 10px;">
                    <button class="context-btn" onclick="filltext()" type="button"><i
                            class="fa-regular fa-file-lines"></i> Try Sample Text</button>
                    <button class="context-btn" type="button"> <i class="fa-regular fa-paste"></i> Paste Text</button>
                </div> -->
                <div class="buttons-container" style="position: absolute; top: 90px; right: 600px;">
                    <button class="context-btn" onclick="filltext()" type="button"><i
                            class="fa-regular fa-file-lines"></i> Try Sample Text</button>
                    <button class="context-btn" type="button"> <i class="fa-regular fa-paste"></i> Paste Text</button>
                </div>


            </div>
            <div style="padding:15px;" class="form-group2">
                <div class="filo">
                    <input type="file" id="pdf_file" name="pdf_file" class="file-input" />
                    <label for="pdf_file" class="file-input-label"><i class="fa-solid fa-cloud-arrow-up"></i> Upload
                        pdf</label>
                </div>
                <br>
                {{ form.num_keywords.label_tag }}
                {{ form.num_keywords }}
                {{ form.num_keywords.help_text }}


                <div>
                    {{ form.option_1.label_tag }}
                    {{ form.option_1 }}
                </div>
                <div>
                    {{ form.option_2.label_tag }}
                    {{ form.option_2 }}
                </div>
                <div>
                    {{ form.option_3.label_tag }}
                    {{ form.option_3 }}
                </div>
                <button type="submit" id="generateBtn">
                    <span class="btn-text">Generate MCQs</span>
                    <span class="loading-icon" style="display: none;">
                        <i class="fa fa-spinner fa-spin"></i>
                    </span>
                </button>
            </div>
        </form>
        <!-- Modal -->
        <div id="loginModal" class="modal">
            <div class="modal-content">
                <span class="close-btn">&times;</span>
                <div class="tab">
                    <button class="tablinks active" onclick="openTab(event, 'Login')">Login</button>
                    <button class="tablinks" onclick="openTab(event, 'Register')">Register</button>
                </div>

                <!-- Login Form -->
                <div id="Login" class="tabcontent" style="display: block;">
                    <form id="Loginform" action="{% url 'login' %}" method="POST">

                        <!-- <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}"> -->

                        <!-- <input type="hidden" name="next" value="{{ request.path }}">  -->
                        <label for="login-email">Email:</label>
                        
                        <input type="email" id="login-email" name="email" placeholder="Enter email" required>

                        <label for="login-password">Password:</label>
                        <input type="password" id="login-password" name="password" placeholder="Enter password" required>

                        <button type="submit" class="submit-btn">Login</button>
                    </form>
                    <button class="google-btn">
                        <img src="{% static 'img/search.png' %}" alt="Google logo">
                        Sign in with Google
                    </button>
                </div>

                <!-- Register Form -->
                <div id="Register" class="tabcontent">
                    <form style="border:none;" id="Registerform" action="{% url 'register' %}" method="POST">

                        <label for="register-email">Email:</label>
                        <input type="email" id="register-email" name="email" placeholder="Enter email" required>

                        <label for="register-password">Password:</label>
                        <input type="password" id="register-password" name="password" placeholder="Enter password" required>

                        <label for="register-confirm-password">Confirm Password:</label>
                        <input type="password" id="register-confirm-password" name="confirm_password" placeholder="Re-type password" required>

                        <button type="submit" class="submit-btn1">Register</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
    const loginUrl = "{% url 'login' %}";
    const registerUrl = "{% url 'register' %}";
</script>
<script src="{% static 'js/index.js' %}" defer></script>
<script>
    const generateBtn = document.getElementById("generateBtn");
    generateBtn.addEventListener("click", function () {
        // Show the loading icon and hide the text
        generateBtn.querySelector(".btn-text").style.display = "none";
        generateBtn.querySelector(".loading-icon").style.display = "inline-block";
    });
    function toggleDropdown() {
        const dropdownMenu = document.getElementById("dropdownMenu");
        dropdownMenu.style.display = dropdownMenu.style.display === "block" ? "none" : "block";
    }

    function filltext() {
        var sampletext = `Machine learning is a branch of artificial intelligence (AI) that enables systems to learn from data and make predictions or decisions without being explicitly programmed.
         It involves the development of algorithms that can identify patterns and correlations in large datasets, enabling systems to improve their performance over time.
          There are various types of machine learning, including supervised learning, where the model is trained on labeled data; unsupervised learning, where the model finds patterns in data without labeled examples; 
          and reinforcement learning, where an agent learns by interacting with an environment and receiving feedback. Machine learning has a wide range of applications, 
          from natural language processing and image recognition to predictive analytics and autonomous vehicles, revolutionizing industries by automating tasks and providing insights that were once difficult or impossible to uncover manually.`;
        document.getElementById("context").value = sampletext;
        var buttonsContainer = document.querySelector('.buttons-container');
        buttonsContainer.classList.add('hidden');
        button.style.display = 'none';
    }

    window.onclick = function (event) {
        if (!event.target.closest('.dropdown')) {
            const dropdownMenu = document.getElementById("dropdownMenu");
            if (dropdownMenu.style.display === "block") {
                dropdownMenu.style.display = "none";
            }
        }
    }
    document.getElementById('context').addEventListener('input', function () {
        var buttonsContainer = document.querySelector('.buttons-container');
        if (this.value.length > 0) {
            buttonsContainer.classList.add('hidden');
        } else {
            buttonsContainer.classList.remove('hidden');
        }
    });
    window.onload = function () {
        document.getElementById('context').focus();
    };
</script>
</body>

</html>
{% endblock %}